<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>–ò–º–ø–æ—Ä—Ç VLESS –∫–ª—é—á–∞</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {font-family: system-ui, sans-serif; background:#f5f7fb; margin:0; padding:32px; color:#111;}
    .card {max-width:520px; margin:auto; background:#fff; border-radius:20px; padding:32px; box-shadow:0 24px 48px rgba(15,35,95,.12);}
    h1 {margin-top:0; font-size:28px;}
    p {line-height:1.6; margin:16px 0;}
    code {display:block; background:#f2f4ff; border-radius:12px; padding:16px; word-break:break-all; font-size:14px;}
    .btn {display:inline-block; margin-top:18px; padding:14px 20px; background:#4463ff; color:#fff; border-radius:12px; text-decoration:none; font-weight:600;}
    .btn.secondary {background:#e4e8ff; color:#2b3674;}
    .note {margin-top:24px; font-size:14px; color:#687089;}
  </style>
  <script>
    let configValue = null;
    let intentUrl = null;

    function decodeConfig() {
      const params = new URLSearchParams(window.location.search);
      const raw = params.get("data");
      if (!raw) return null;

      const base64 = raw.replace(/-/g, "+").replace(/_/g, "/");
      const padded = base64 + "=".repeat((4 - base64.length % 4) % 4);
      try {
        const binary = atob(padded);
        const bytes = Uint8Array.from(binary, ch => ch.charCodeAt(0));
        const decoder = new TextDecoder("utf-8");
        return decoder.decode(bytes);
      } catch (e) {
        console.error("decode error", e);
        return null;
      }
    }

    function buildIntentUrl(link) {
      const [scheme, rest] = link.split("://", 2);
      if (!scheme || !rest) return null;
      const encodedRest = rest.replace(/#/g, encodeURIComponent("#"));
      return `intent://${encodedRest}#Intent;scheme=${scheme};package=com.v2raytun.android;end`;
    }

    function openApp() {
      if (!intentUrl) return;
      window.location.href = intentUrl;
    }

    document.addEventListener("DOMContentLoaded", () => {
      configValue = decodeConfig();
      const status = document.getElementById("status");
      const manualBtn = document.getElementById("manual");
      const directLink = document.getElementById("direct-link");

      if (configValue) {
        document.getElementById("placeholder").textContent = configValue;
        intentUrl = buildIntentUrl(configValue);
        if (intentUrl) {
          manualBtn.addEventListener("click", openApp);
          manualBtn.disabled = false;
        } else {
          manualBtn.disabled = true;
        }
        directLink.href = configValue;
        status.textContent = "–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å v2RayTun.";
      } else {
        status.textContent = "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∫–ª—é—á üòî –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Å—ã–ª–∫—É –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —à–∞–≥ –≤ –±–æ—Ç–µ.";
        manualBtn.style.display = "none";
        directLink.style.display = "none";
      }
    });
  </script>
</head>
<body>
  <div class="card">
    <h1>–ò–º–ø–æ—Ä—Ç VLESS –∫–ª—é—á–∞</h1>
    <p id="status">–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Å—ã–ª–∫—É‚Ä¶</p>

    <button id="manual" class="btn" type="button" disabled>–û—Ç–∫—Ä—ã—Ç—å –≤ v2RayTun –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</button>
    <a id="direct-link" class="btn secondary" href="#" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞–ø—Ä—è–º—É—é</a>

    <div class="note">
      –ï—Å–ª–∏ –æ–∫–Ω–æ –Ω–µ –ø–æ—è–≤–∏–ª–æ—Å—å, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á –≤—Ä—É—á–Ω—É—é –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:
      <code id="placeholder"></code>
    </div>
  </div>
</body>
</html>
